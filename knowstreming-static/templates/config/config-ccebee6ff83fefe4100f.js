define("config",["react","moment","react-dom","lodash","react-router-dom","single-spa-react"],(function(e,t,n,a,r,i){return function(e){function t(t){for(var a,o,c=t[0],l=t[1],s=t[2],m=0,d=[];m<c.length;m++)o=c[m],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&d.push(r[o][0]),r[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(u&&u(t);d.length;)d.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],a=!0,c=1;c<n.length;c++){var l=n[c];0!==r[l]&&(a=!1)}a&&(i.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={0:0},i=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/config/";var c=window.webpackJsonpconfig=window.webpackJsonpconfig||[],l=c.push.bind(c);c.push=t,c=c.slice();for(var s=0;s<c.length;s++)t(c[s]);var u=l;return i.push([231,1]),n()}({0:function(t,n){t.exports=e},208:function(e,t){e.exports=i},231:function(e,t,n){e.exports=n(375)},247:function(e,t){},290:function(e){e.exports=JSON.parse('{"name":"config-manager-fe","port":"8001","version":"1.0.0","description":"kafka配置管理平台","author":"joysunchao <joysunchao@didiglobal.com>","systemName":"config","ident":"config","homepage":"","license":"ISC","scripts":{"test":"echo \\"Error: run tests from root\\" && exit 1","start":"cross-env NODE_ENV=development webpack-dev-server","build":"cross-env NODE_ENV=production webpack --max_old_space_size=8000"},"dependencies":{"@knowdesign/icons":"^1.0.2","babel-preset-react-app":"^10.0.0","classnames":"^2.2.6","dotenv":"^16.0.1","knowdesign":"1.3.7","less":"^3.9.0","lodash":"^4.17.11","mobx":"4.15.7","mobx-react":"6.0.0","moment":"^2.24.0","query-string":"^5.0.1","react":"16.12.0","react-codemirror2":"^7.2.1","react-dom":"16.12.0","react-intl":"^3.2.1","react-router-cache-route":"^1.11.1","single-spa":"^5.8.0","single-spa-react":"^2.14.0"},"devDependencies":{"@ant-design/icons":"^4.6.2","@babel/core":"^7.5.5","@babel/plugin-proposal-class-properties":"^7.4.0","@babel/plugin-proposal-decorators":"^7.4.0","@babel/plugin-proposal-export-default-from":"^7.2.0","@babel/plugin-proposal-export-namespace-from":"^7.5.2","@babel/plugin-proposal-object-rest-spread":"^7.4.3","@babel/plugin-proposal-optional-chaining":"^7.16.0","@babel/plugin-proposal-private-methods":"^7.14.5","@babel/plugin-transform-modules-commonjs":"^7.12.1","@babel/plugin-transform-object-assign":"^7.12.1","@babel/plugin-transform-runtime":"^7.4.3","@babel/preset-env":"^7.4.2","@babel/preset-react":"^7.0.0","@babel/preset-typescript":"^7.14.5","@pmmmwh/react-refresh-webpack-plugin":"^0.5.1","@types/lodash":"^4.14.138","@types/react-dom":"^17.0.5","@types/react-router":"5.1.18","@types/react-router-dom":"^5.3.3","@types/single-spa-react":"^2.12.0","@typescript-eslint/eslint-plugin":"4.13.0","@typescript-eslint/parser":"4.13.0","axios":"^0.21.1","babel-eslint":"10.1.0","babel-loader":"^8.2.2","babel-plugin-import":"^1.12.0","cache-loader":"^4.1.0","case-sensitive-paths-webpack-plugin":"^2.2.0","clean-webpack-plugin":"^3.0.0","cross-env":"^7.0.2","css-loader":"^2.1.0","eslint":"7.30.0","eslint-config-prettier":"8.3.0","eslint-plugin-prettier":"3.4.0","eslint-plugin-react":"7.22.0","eslint-plugin-react-hooks":"4.2.0","file-loader":"^6.0.0","happypack":"^5.0.1","hard-source-webpack-plugin":"^0.13.1","html-webpack-plugin":"^4.0.0","husky":"4.3.7","less-loader":"^4.1.0","lint-staged":"10.5.3","mini-css-extract-plugin":"^1.3.0","mobx":"4.15.7","mobx-react":"6.0.0","optimize-css-assets-webpack-plugin":"^5.0.1","prettier":"2.3.2","progress-bar-webpack-plugin":"^1.12.1","react-refresh":"^0.10.0","react-router-dom":"5.2.1","stats-webpack-plugin":"^0.7.0","ts-loader":"^8.0.11","typescript":"4.6.4","webpack":"^4.40.0","webpack-bundle-analyzer":"^4.5.0","webpack-cli":"^3.2.3","webpack-dev-server":"^3.2.1","webpack-merge":"^4.2.1"}}')},375:function(e,t,n){"use strict";n.r(t),n.d(t,"bootstrap",(function(){return mt})),n.d(t,"mount",(function(){return dt})),n.d(t,"unmount",(function(){return pt}));var a=n(0),r=n.n(a),i=n(43),o=n.n(i),c=n(208),l=n.n(c),s=n(48),u=n(46),m=n.n(u),d=n(115),p=n(31),f=n.n(p),g=n(224),b=n(72);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}g.a.config({top:16,duration:3});var E=function(e,t){g.a[e](function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:r.a.createElement(b.a,{type:"icon-".concat(e,"-circle")})},t))},O={info:function(e){E("info",e)},success:function(e){E("success",e)},warning:function(e){E("warning",e)},error:function(e){E("error",e)}},v=function(){window.location.pathname.toLowerCase().startsWith("/login")||window.history.replaceState({},"","/login?redirect=".concat(window.location.href.slice(window.location.origin.length)))},y=d.a.service;y.interceptors.response.handlers=[],y.interceptors.request.use((function(e){var t=d.a.getCookie("X-SSO-USER"),n=d.a.getCookie("X-SSO-USER-ID");if(t&&n)return e.headers["X-SSO-USER"]=t,e.headers["X-SSO-USER-ID"]=n,e;v()}),(function(e){return e})),y.interceptors.response.use((function(e){var t=e.data;if(0!==t.code&&200!==t.code)throw O.error({message:"错误信息",description:t.message}),t;return t}),(function(e){var t=null==e?void 0:e.config;if(!t||!t.retryTimes)return S(e);var n=t.__retryCount,a=void 0===n?0:n,r=t.retryDelay,i=void 0===r?300:r,o=t.retryTimes;return t.__retryCount=a,a>=o?S(e):(t.__retryCount++,new Promise((function(e){setTimeout((function(){e()}),i)})).then((function(){return y(t)})))}));var j,w,S=function(e){if(null!=e&&e.response)switch(e.response.status){case 401:v();break;case 403:location.href="/403";break;case 405:O.error({message:"错误",duration:3,description:"".concat(e.response.data.message||"请求方式错误")});break;case 500:O.error({message:"错误",duration:3,description:"服务错误，请重试！"});break;case 502:O.error({message:"错误",duration:3,description:"网络错误，请重试！"});break;default:O.error({message:"连接出错",duration:3,description:"".concat(e.response.status)})}else O.error({description:"请重试或检查服务",message:"连接超时!  ",duration:3});return Promise.reject(e)},P=n(179),N=n(219),C=n(290).ident,k={name:"".concat(C),path:"",icon:"#icon-kafka",children:[{name:"setting",path:"setting",icon:"icon-Cluster"},{name:"user",path:"user",icon:"icon-Brokers"},{name:"operationLog",path:"operation-log",icon:"icon-Topics"}]},I=(f()({},"menu.".concat(C,".home"),!0),"menu.".concat(C,".home"),"menu.".concat(C,".dev"),"menu.".concat(C,".dev.detail"),"menu.".concat(C,".dev.table"),j={},f()(j,"menu.".concat(C,".setting"),"配置管理"),f()(j,"menu.".concat(C,".user"),"用户管理"),f()(j,"menu.".concat(C,".operationLog"),"审计日志"),f()(j,"sider.footer.hide","收起"),f()(j,"sider.footer.expand","展开"),j),x=(w={},f()(w,"menu.".concat(C,".setting"),"setting"),f()(w,"menu.".concat(C,".user"),"userManagement"),f()(w,"menu.".concat(C,".operationLog"),"operationLog"),f()(w,"sider.footer.hide","hide"),f()(w,"sider.footer.expand","expand"),w),D=n(389),L=n(384),T=n(390),z=n(15),F=n.n(z),R=n(388),_=n(157),A=n(387),U=n(392),G=n(393),V=n(45),H=n(381),B=n(125),M=n(394),q=n(86),Y=n(385),K=n(225);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}K.b.config({top:16});var W=function(e,t,n,a){!function(e){return"[object Object]"===Object.prototype.toString.call(e)&&!!e.content}(t)?K.b[e]({icon:r.a.createElement(b.a,{type:"icon-".concat(e,"-circle")}),content:t,duration:n,onClose:a}):K.b[e](function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({icon:r.a.createElement(b.a,{type:"icon-".concat(e,"-circle")})},t))},X={info:function(e,t,n){W("info",e,t,n)},success:function(e,t,n){W("success",e,t,n)},warning:function(e,t,n){W("warning",e,t,n)},error:function(e,t,n){W("error",e,t,n)}},Z=n(226),$=n(41),Q=n.n($),ee=n(172);n(291),n(292),n(293),n(294);function te(e){return"".concat("/logi-security/api/v1").concat(e)}var ne,ae={permissionTree:te("/permission/tree"),configGroupList:te("/config/group/list"),configList:te("/config/page"),configDetail:te("/config/get"),configSwtichStatus:te("/config/switch"),addConfig:te("/config/add"),editConfig:te("/config/edit"),delConfig:te("/config/del"),userList:te("/user/page"),user:function(e){return te("/user/".concat(e))},addUser:te("/user/add"),editUser:te("/user/edit"),getUsersByRoleId:function(e){return te("/user/list/role/".concat(e))},editRole:te("/role"),roleList:te("/role/page"),simpleRoleList:te("/role/list"),role:function(e){return te("/role/".concat(e))},getAssignedUsersByRoleId:function(e){return te("/role/assign/list/".concat(e))},assignRoles:te("/role/assign"),checkRole:function(e){return te("/role/delete/check/".concat(e))},oplogTypeList:te("/oplog/type/list"),oplogList:te("/oplog/page")},re={current:1,pageSize:10,total:0},ie=function(e){var t=e.title,n=e.children;return r.a.createElement("div",{className:"typical-list-card"},r.a.createElement("div",{className:"typical-list-card-container"},r.a.createElement("div",{className:"title"},t),n))};function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.SYS_MANAGE="系统管理",e.CONFIG_ADD="配置管理-新增配置",e.CONFIG_EDIT="配置管理-编辑配置",e.CONFIG_DEL="配置管理-删除配置",e.USER_DEL="用户管理-删除人员",e.USER_CHANGE_PASS="用户管理-修改人员密码",e.USER_EDIT="用户管理-编辑人员",e.USER_ADD="用户管理-新增人员",e.ROLE_DEL="用户管理-删除角色",e.ROLE_ASSIGN="用户管理-分配用户角色",e.ROLE_EDIT="用户管理-编辑角色",e.ROLE_ADD="用户管理-新增角色"}(ne||(ne={}));var le,se=function(){var e=T.a.useGlobalValue(),t=F()(e,2)[1];return Object(a.useLayoutEffect)((function(){var e=localStorage.getItem("userInfo");try{var n=JSON.parse(e),a=n.id;if(!a)throw"err";!function(e,n){var a=d.a.request("/logi-security/api/v1/user/".concat(n)),r=d.a.request("/logi-security/api/v1/permission/tree");Promise.all([r,a]).then((function(n){var a=F()(n,2),r=a[0],i=a[1],o=r.childList,c=i.permissionTreeVO.childList.find((function(e){return e.permissionName===ne.SYS_MANAGE})),l=[];c&&c.childList.forEach((function(e){return e.has&&l.push(e.permissionName)}));var s=function(e){return e&&l.includes(e)};t((function(t){return ce(ce({},t),{},{permissions:o,userPermissions:l,hasPermission:s,userInfo:e})}))}))}(n,a)}catch(e){v()}}),[]),r.a.createElement(r.a.Fragment,null)};function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit"}(le||(le={})),n(295),n(296);var de,pe,fe=d.a.request,ge=R.a.confirm,be=_.a.TextArea,he=Object(a.forwardRef)((function(e,t){var n=Object(a.useState)({}),i=F()(n,2),o=i[0],c=i[1],l=Object(a.useState)(le.Add),s=F()(l,2),u=s[0],m=s[1],d=A.a.useForm(),p=F()(d,1)[0],f=Object(a.useState)(!1),g=F()(f,2),b=g[0],h=g[1],E=Object(a.useState)([]),O=F()(E,2),v=O[0],y=O[1],j=Object(a.useState)(!1),w=F()(j,2),S=w[0],P=w[1],N=Object(a.useState)(""),C=F()(N,2),k=C[0],I=C[1],x=Object(a.useRef)((function(){})),D=function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(r.value)try{r.value=JSON.stringify(JSON.parse(r.value),null,2)}catch(e){}p.setFieldsValue(me(me({},r),{},{status:1===r.status})),c(r),y(a),I(r.value),m(t),h(e),x.current=n},L=function(){h(!1),P(!1),c({}),p.resetFields(),I("")};return Object(a.useImperativeHandle)(t,(function(){return{onOpen:D}})),r.a.createElement(U.a,{className:"config-manage-edit-drawer",title:"".concat(u===le.Add?"新增":"编辑","配置"),width:480,visible:b,maskClosable:!1,onClose:L,extra:r.a.createElement(G.b,null,r.a.createElement(V.a,{size:"small",onClick:L},"取消"),r.a.createElement(V.a,{type:"primary",size:"small",loading:S,onClick:function(){p.validateFields().then((function(e){P(!0),e.status=e.status?1:2;var t=u===le.Add,n=t?ae.addConfig:ae.editConfig;fe(n,{method:t?"PUT":"POST",data:Object.assign(e,t?{}:{id:o.id})}).then((function(e){x.current(),L(),X.success("成功".concat(t?"新增":"更新","配置"))}),(function(){return P(!1)}))}))}},"确定"),r.a.createElement(H.a,{type:"vertical"}))},r.a.createElement(A.a,{form:p,layout:"vertical"},r.a.createElement(A.a.Item,{label:"模块",name:"valueGroup",rules:[{required:!0,message:"模块不能为空"}]},r.a.createElement(B.a,{options:v,placeholder:"请选择模块"})),r.a.createElement(A.a.Item,{label:"配置键",name:"valueName",rules:[{required:!0,message:"配置键不能为空"}]},r.a.createElement(_.a,{placeholder:"请输入配置键",maxLength:100})),r.a.createElement(A.a.Item,{label:"配置值",name:"value",rules:[{required:!0,message:"配置值不能为空"}]},r.a.createElement("div",null,r.a.createElement(ee.Controlled,{className:"codemirror-form-item",value:k,options:{mode:"application/json",lineNumbers:!0,lineWrapper:!0,autoCloseBrackets:!0,smartIndent:!0,tabSize:2},onBeforeChange:function(e,t,n){p.setFieldsValue({value:n}),p.validateFields(["value"]),I(n)}}))),r.a.createElement(A.a.Item,{label:"描述",name:"memo",rules:[{required:!0,message:"必须输入描述"}]},r.a.createElement(be,{placeholder:"请输入描述",maxLength:200})),r.a.createElement(A.a.Item,{label:"启用状态",name:"status",valuePropName:"checked"},r.a.createElement(M.a,null))))})),Ee=Object(a.forwardRef)((function(e,t){var n=Object(a.useState)(!1),i=F()(n,2),o=i[0],c=i[1],l=Object(a.useState)(""),s=F()(l,2),u=s[0],m=s[1];return Object(a.useImperativeHandle)(t,(function(){return{setVisible:function(e,t){var n="";try{n=JSON.stringify(JSON.parse(t),null,2)}catch(e){n=t}m(n),c(e)}}})),r.a.createElement(R.a,{className:"config-manage-value-modal",title:"配置值",visible:o,centered:!0,footer:null,onCancel:function(){c(!1),m("")},maskClosable:!1,destroyOnClose:!0},r.a.createElement(ee.Controlled,{value:u,options:{mode:"application/json",lineNumbers:!0,lineWrapper:!0,autoCloseBrackets:!0,smartIndent:!0,tabSize:2},onBeforeChange:function(){}}))})),Oe=n(386),ve=n(227);!function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit"}(de||(de={})),function(e){e[e.Add=0]="Add",e[e.Edit=1]="Edit",e[e.View=2]="View"}(pe||(pe={}));var ye=n(65),je=n.n(ye),we=n(77),Se=n(383),Pe=n(382),Ne=function(e){var t=e.options,n=e.initSelectedOptions,i=void 0===n?[]:n,o=e.formInstance,c=e.fieldName,l=e.groupIdx,s=e.disabled,u=void 0!==s&&s,m=e.allCheckText,d=void 0===m?"全选":m,p=Object(a.useState)([]),g=F()(p,2),b=g[0],h=g[1],E=Object(a.useState)(!1),O=F()(E,2),v=O[0],y=O[1],j=Object(a.useState)(!1),w=F()(j,2),S=w[0],P=w[1],N=function(e){var t=o.getFieldValue(c),n=[].concat(t);n[l]=e,o.setFieldsValue(f()({},c,n))};return Object(a.useLayoutEffect)((function(){var e=je()(i).sort();(b.length!==e.length||b.some((function(t,n){return t!==e[n]})))&&(h(e),N(e))}),[i]),Object(a.useLayoutEffect)((function(){y(!!i.length&&i.length<t.length),P(!!i.length&&t.length===i.length)}),[t,i]),r.a.createElement("div",{style:{marginBottom:30}},r.a.createElement("div",{style:{marginBottom:12}},r.a.createElement(we.a,{disabled:u,indeterminate:v,onChange:function(e){var n=e.target.checked?t:[];N(n.map((function(e){return e.value}))),h(n.map((function(e){return e.value}))),y(!1),P(e.target.checked)},checked:S},d)),r.a.createElement(we.a.Group,{disabled:u,style:{width:"100%"},value:b,onChange:function(e){e.sort(),N(e),h(e),y(!!e.length&&e.length<t.length),P(e.length===t.length)}},r.a.createElement(Se.a,{gutter:[10,10]},t.map((function(e){return r.a.createElement(Pe.a,{span:8,key:e.value},r.a.createElement(we.a,{value:e.value,className:"checkbox-content-ellipsis"},e.label.replace("Cluster-Load","")))})))))},Ce=n(113),ke=n(395),Ie=function(e){var t=window.getComputedStyle(e);return[t.marginLeft,t.marginRight].reduce((function(e,t){return e+Number(t.slice(0,-2))}),0)},xe=function(e){var t=e.list,n=void 0===t?[]:t,i=e.expandTagContent,o=e.placement,c=void 0===o?"bottomRight":o;n.sort();var l=Object(a.useRef)(null),s=Object(a.useState)({list:n,isHideExpandNode:!0,endI:-1,calculated:!1}),u=F()(s,2),m=u[0],d=u[1],p=Object(a.useState)(n),f=F()(p,2),g=f[0],b=f[1];return Object(a.useEffect)((function(){setTimeout((function(){return function(){var e=l.current,t=e.offsetWidth,n=Array.from(l.current.children),a=n.length,r=n[a-2];if(r.offsetLeft+r.offsetWidth-e.offsetLeft>t){var i=n[a-1],o=Ie(r),c=i.offsetWidth+Ie(i);n.some((function(e,n){var a=e.offsetWidth+o;return c+a<t?(c+=a,!1):(d({list:g,isHideExpandNode:!1,endI:n,calculated:!0}),!0)}))}else d({list:g,isHideExpandNode:!0,endI:-1,calculated:!0})}()}))}),[g]),Object(a.useEffect)((function(){(n.length!==g.length||g.some((function(e,t){return e!==n[t]})))&&(b(n),d({list:n,isHideExpandNode:!0,endI:-1,calculated:!1}))}),[n]),r.a.createElement("div",{className:"list-with-hide-container",ref:l},m.list.map((function(e,t){return r.a.createElement("div",{key:t,className:"container-item ".concat(m.calculated?m.isHideExpandNode?"show":t>=m.endI?"hide":"show":"")},e)})),r.a.createElement(ke.a,{placement:c,overlayClassName:"tags-with-hide-popover",content:r.a.createElement("div",{className:"container-item-popover"},m.list.map((function(e){return r.a.createElement("div",{key:e,className:"container-item"},e)})))},r.a.createElement("div",{className:"expand-item ".concat(m.calculated?m.isHideExpandNode?"hide":"show":"")},"string"==typeof i?i:i(m.list.length),r.a.createElement(Ce.a,null))))};function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Te=R.a.confirm,ze=d.a.request,Fe=/^[a-zA-Z0-9_]{6,12}$/,Re=/^[a-zA-Z0-9_]{3,128}$/,_e=/^[\u4e00-\u9fa5a-zA-Z0-9_]{1,128}$/,Ae=Object(a.forwardRef)((function(e,t){var n=T.a.useGlobalValue(),i=F()(n,1)[0],o=A.a.useForm(),c=F()(o,1)[0],l=Object(a.useState)(!1),s=F()(l,2),u=s[0],m=s[1],d=Object(a.useState)(!1),p=F()(d,2),f=p[0],g=p[1],b=Object(a.useState)(de.Add),h=F()(b,2),E=h[0],O=h[1],v=Object(a.useState)(),y=F()(v,2),j=(y[0],y[1]),w=Object(a.useState)([]),S=F()(w,2),P=S[0],N=S[1],C=Object(a.useState)([]),k=F()(C,2),I=k[0],x=k[1],D=Object(a.useRef)((function(){})),L=function(e,t,n,a,r){c.setFieldsValue(a),j(a),x(null!=a&&a.roleList?a.roleList.map((function(e){return e.id})):[]),N(r),O(t),m(e),D.current=n},z=function(){m(!1),c.resetFields(),j(void 0),x([]),N([]),g(!1)};return Object(a.useImperativeHandle)(t,(function(){return{onOpen:L}})),r.a.createElement(U.a,{title:"".concat(E===de.Add?"新增":"编辑","用户"),width:480,visible:u,maskClosable:!1,onClose:z,extra:r.a.createElement(G.b,null,r.a.createElement(V.a,{size:"small",onClick:z},"取消"),r.a.createElement(V.a,{type:"primary",size:"small",loading:f,onClick:function(){c.validateFields().then((function(e){g(!0),e.roleIds=e.roleIds.flat(),e.pw||delete e.pw,(E===de.Add?ze(ae.addUser,{method:"PUT",data:e}):ze(ae.editUser,{method:"POST",data:Le(Le({},e),{},{phone:Date.now()})})).then((function(e){D.current(),z(),X.success("".concat(E===de.Add?"新增":"编辑","用户成功"))}),(function(){return g(!1)}))}))}},"确定"),r.a.createElement(H.a,{type:"vertical"}))},r.a.createElement(A.a,{form:c,layout:"vertical"},r.a.createElement(A.a.Item,{label:"用户账号",name:"userName",rules:[{required:!0,message:"用户账号不能为空"},{pattern:Re,message:"用户账号只能由英文大小写、数字、下划线(_)组成，长度限制在3～128字符"}]},r.a.createElement(_.a,{disabled:E===de.Edit,placeholder:"请输入用户账号"})),E===de.Add||i.hasPermission(ne.USER_EDIT)?r.a.createElement(A.a.Item,{label:"用户实名",name:"realName",rules:[{required:!0,message:"用户实名不能为空"},{pattern:_e,message:"用户实名只能由中英文大小写、数字、下划线组成，长度限制在1～128字符"}]},r.a.createElement(_.a,{placeholder:"请输入用户实名"})):r.a.createElement(r.a.Fragment,null),E===de.Add||i.hasPermission(ne.USER_CHANGE_PASS)?r.a.createElement(A.a.Item,{label:"".concat(E===de.Edit?"新":"","密码"),name:"pw",tooltip:{title:"密码支持英文、数字、下划线(_)，长度限制在6~12字符",icon:r.a.createElement(ve.a,null)},rules:[{required:E===de.Add,message:"密码不能为空"},{pattern:Fe,message:"密码只能由英文、数字、下划线(_)组成，长度限制在6~12字符"}]},r.a.createElement(_.a.Password,{placeholder:"请输入密码"})):r.a.createElement(r.a.Fragment,null),E===de.Add||i.hasPermission(ne.USER_EDIT)?r.a.createElement(A.a.Item,{label:"分配角色",name:"roleIds",rules:[function(){return{validator:function(e,t){return Array.isArray(t)&&t.some((function(e){return!!e.length}))?Promise.resolve():Promise.reject(new Error("请为用户至少分配一名角色"))}}}]},r.a.createElement(Ne,{formInstance:c,fieldName:"roleIds",options:P,initSelectedOptions:I,groupIdx:0})):r.a.createElement(r.a.Fragment,null)))})),Ue=function(e){var t=e.curTabKey,n=T.a.useGlobalValue(),i=F()(n,1)[0],o=Object(a.useState)(!0),c=F()(o,2),l=c[0],s=c[1],u=Object(a.useState)([]),m=F()(u,2),d=m[0],p=m[1],f=Object(a.useState)(re),g=F()(f,2),h=g[0],E=g[1],O=Object(a.useState)([]),v=F()(O,2),y=v[0],j=v[1],w=A.a.useForm(),S=F()(w,1)[0],P=(Object(a.useRef)(null),Object(a.useRef)(null)),N=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=S.getFieldsValue(),a=Le(Le({page:h.current,size:h.pageSize},n),t);s(!0),ze(ae.userList,{method:"POST",data:a}).then((function(t){var n=t.pagination,a=n.pageNo,r=n.pageSize,i=n.pages,o=n.total;if(a>i&&0!==i)return e({page:i}),!1;E(Le(Le({},h),{},{current:a,pageSize:r,total:o})),p(t.bizData),s(!1)}),(function(){return s(!1)}))},C=Object(a.useCallback)((function(){var e=[{title:"用户账号",dataIndex:"userName"},{title:"用户实名",dataIndex:"realName"},{title:"分配角色",dataIndex:"roleList",width:560,render:function(e){var t=e.map((function(e){return e.roleName}));return r.a.createElement(xe,{list:t,expandTagContent:function(e){return"共有".concat(e,"个角色")}})}},{title:"最后更新时间",dataIndex:"updateTime",render:function(e){return Q()(e).format("YYYY-MM-DD HH:mm:ss")}}];return i.hasPermission&&(i.hasPermission(ne.USER_CHANGE_PASS)||i.hasPermission(ne.USER_EDIT)||i.hasPermission(ne.USER_DEL))&&e.push({title:"操作",dataIndex:"",width:140,render:function(e){return r.a.createElement(r.a.Fragment,null,i.hasPermission&&(i.hasPermission(ne.USER_EDIT)||i.hasPermission(ne.USER_CHANGE_PASS))?r.a.createElement(V.a,{type:"link",size:"small",style:{paddingLeft:0},onClick:function(){return P.current.onOpen(!0,de.Edit,N,e,y)}},"编辑"):r.a.createElement(r.a.Fragment,null),i.hasPermission&&i.hasPermission(ne.USER_DEL)?r.a.createElement(V.a,{type:"link",size:"small",onClick:function(){return function(e){Te({title:"删除提示",content:"确定要删除用户⌈".concat(e.userName,"⌋吗?"),centered:!0,maskClosable:!0,okType:"primary",okText:"删除",okButtonProps:{size:"small",danger:!0},cancelButtonProps:{size:"small"},onOk:function(){return ze(ae.user(e.id),{method:"DELETE"}).then((function(e){X.success("删除成功"),N()}))},onCancel:function(){}})}(e)}},"删除"):r.a.createElement(r.a.Fragment,null))}}),e}),[i,N,y]);return Object(a.useEffect)((function(){"user"===t&&(N(),ze(ae.simpleRoleList).then((function(e){var t=e.map((function(e){var t=e.id;return{label:e.roleName,value:t}}));j(t)})))}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"operate-bar"},r.a.createElement("div",{className:"left"},r.a.createElement("div",{className:"refresh-icon",onClick:function(){return N()}},r.a.createElement(b.a,{className:"icon",type:"icon-shuaxin1"})),r.a.createElement(H.a,{type:"vertical",style:{height:20,top:0}}),r.a.createElement(A.a,{form:S,layout:"inline",onFinish:function(){return N({page:1})}},r.a.createElement(A.a.Item,{name:"userName"},r.a.createElement(_.a,{placeholder:"请输入用户账号"})),r.a.createElement(A.a.Item,{name:"realName"},r.a.createElement(_.a,{placeholder:"请输入用户实名"})),r.a.createElement(A.a.Item,{name:"roleId"},r.a.createElement(B.a,{style:{width:190},placeholder:"选择平台已创建的角色名",options:y})),r.a.createElement(A.a.Item,null,r.a.createElement(V.a,{type:"primary",ghost:!0,htmlType:"submit"},"查询")))),i.hasPermission&&i.hasPermission(ne.USER_ADD)?r.a.createElement(V.a,{type:"primary",icon:r.a.createElement(Z.a,null),onClick:function(){return P.current.onOpen(!0,de.Add,N,{},y)}},"新增用户"):r.a.createElement(r.a.Fragment,null)),r.a.createElement(Y.a,{tableProps:{showHeader:!1,loading:l,rowKey:"id",dataSource:d,paginationProps:h,columns:C,lineFillColor:!0,attrs:{onChange:function(e){N({page:e.current,size:e.pageSize})},scroll:{scrollToFirstRowOnChange:!0,x:!0,y:"calc(100vh - 326px)"}}}}),r.a.createElement(Ae,{ref:P}))},Ge=n(218),Ve=n(391),He=n(380),Be=n(63);function Me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Me(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ye=d.a.request,Ke=R.a.confirm,Je=_.a.TextArea,We=Object(a.forwardRef)((function(e,t){var n=T.a.useGlobalValue(),i=F()(n,1)[0],o=A.a.useForm(),c=F()(o,1)[0],l=Object(a.useState)(!1),s=F()(l,2),u=s[0],m=s[1],d=Object(a.useState)(pe.Add),p=F()(d,2),f=p[0],g=p[1],b=Object(a.useState)(),h=F()(b,2),E=h[0],O=h[1],v=Object(a.useState)([]),y=F()(v,2),j=y[0],w=y[1],S=Object(a.useState)(!1),P=F()(S,2),N=P[0],C=P[1],k=Object(a.useState)({}),I=F()(k,2),x=I[0],D=I[1],L=Object(a.useState)(!1),z=F()(L,2),R=z[0],B=z[1],M=Object(a.useRef)((function(){}));Object(a.useEffect)((function(){var e=i.permissions;if(e&&e.length){var t=e.map((function(e){var t={id:e.id,name:e.permissionName,essentialPermission:void 0,options:[]};return t.options=e.childList.map((function(e){return"多集群管理查看"!==e.permissionName&&"系统管理查看"!==e.permissionName||(t.essentialPermission={label:e.permissionName,value:e.id}),{label:e.permissionName,value:e.id}})),t}));w(t)}}),[i]),Object(a.useEffect)((function(){E&&(C(!0),Ye(ae.role(E.id)).then((function(e){var t={};e.permissionTreeVO.childList.forEach((function(e){t[e.id]=[],e.childList.forEach((function(n){return n.has&&t[e.id].push(n.id)}))})),D(t),C(!1)})))}),[E]);var q=function(e,t,n,a){D({}),c.setFieldsValue(a),M.current=n,O(a),g(t),m(e)},Y=function(){m(!1),O(void 0),c.resetFields(),B(!1)};return Object(a.useImperativeHandle)(t,(function(){return{onOpen:q}})),r.a.createElement(U.a,{title:"".concat(f===pe.Add?"新增角色":f===pe.Edit?"编辑角色":"查看角色详情"),className:"role-tab-detail",width:600,visible:u,maskClosable:!1,onClose:Y,extra:r.a.createElement(G.b,null,f!==pe.View&&r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{size:"small",onClick:Y},"取消"),r.a.createElement(V.a,{type:"primary",size:"small",loading:R,onClick:function(){c.validateFields().then((function(e){e.permissionIdList.forEach((function(e,t){var n;Array.isArray(e)||(e=[]),null!==(n=e)&&void 0!==n&&n.length&&e.push(j[t].id)})),e.permissionIdList=e.permissionIdList.flat(),B(!0),Ye(ae.editRole,{method:f===pe.Add?"POST":"PUT",data:Object.assign(e,f===pe.Edit?{id:E.id}:{})}).then((function(e){M.current(),Y(),D({}),X.success("".concat(f===pe.Add?"新增":"编辑","角色成功"))}),(function(){return B(!1)}))}))}},"确定"),r.a.createElement(H.a,{type:"vertical"})))},f===pe.View?r.a.createElement(r.a.Fragment,null,r.a.createElement(Se.a,{gutter:[12,12],className:"desc-row"},r.a.createElement(Pe.a,{span:3,className:"label-col"},"角色名称:"),r.a.createElement(Pe.a,{span:21,className:"value-col"},E&&E.roleName||"-"),r.a.createElement(Pe.a,{span:3,className:"label-col"},"描述:"),r.a.createElement(Pe.a,{span:21,className:"value-col"},E&&E.description||"-")),r.a.createElement("div",{className:"role-permissions-container"},r.a.createElement("div",{className:"title"},"角色绑定权限项"),r.a.createElement(r.a.Fragment,null,j.length?r.a.createElement(Ge.a,{spinning:N},j.map((function(e,t){return r.a.createElement(Ne,{key:t,formInstance:c,fieldName:"permissionIdList",options:e.options,initSelectedOptions:x[e.id]||[],groupIdx:t,allCheckText:e.name,disabled:!0})}))):r.a.createElement(r.a.Fragment,null)))):r.a.createElement(A.a,{form:c,layout:"vertical"},r.a.createElement(A.a.Item,{label:"角色名称",name:"roleName",rules:[{required:!0,message:"角色名称不能为空"},{pattern:/^[\u4e00-\u9fa5a-zA-Z0-9_]{3,128}$/,message:"角色名称只能由中英文大小写、数字、下划线(_)组成，长度限制在3～128字符"}]},r.a.createElement(_.a,{placeholder:"请输入角色名称"})),r.a.createElement(A.a.Item,{label:"描述",name:"description",rules:[{required:!0,message:"描述不能为空"}]},r.a.createElement(Je,{placeholder:"请输入描述",maxLength:200})),r.a.createElement(A.a.Item,{label:"分配权限",name:"permissionIdList",required:!0,rules:[function(){return{validator:function(e,t){if(Array.isArray(t)&&t.some((function(e){return!(null==e||!e.length)}))){var n=[];return t.forEach((function(e,t){null!=e&&e.length&&!e.includes(j[t].essentialPermission.value)&&n.push("[".concat(j[t].essentialPermission.label,"]"))})),n.length?Promise.reject("您必须分配 ".concat(n.join(" 和 ")," 权限")):Promise.resolve()}return Promise.reject(new Error("请为角色至少分配一项权限"))}}}]},r.a.createElement(r.a.Fragment,null,j.length?r.a.createElement(Ge.a,{spinning:N},j.map((function(e,t){return r.a.createElement(Ne,{key:t,formInstance:c,fieldName:"permissionIdList",options:e.options,initSelectedOptions:x[e.id]||[],groupIdx:t,allCheckText:e.name})}))):r.a.createElement(r.a.Fragment,null)))))})),Xe=Object(a.forwardRef)((function(e,t){var n=Object(a.useState)(!1),i=F()(n,2),o=i[0],c=i[1],l=Object(a.useState)(void 0),s=F()(l,2),u=s[0],m=s[1],d=Object(a.useState)([]),p=F()(d,2),f=p[0],g=p[1],b=Object(a.useState)([]),h=F()(b,2),E=h[0],O=h[1],v=Object(a.useState)(!1),y=F()(v,2),j=y[0],w=y[1],S=Object(a.useState)(!1),P=F()(S,2),N=P[0],C=P[1],k=Object(a.useRef)((function(){})),I=function(){c(!1),m(void 0),g([]),O([]),w(!1),C(!1)};return Object(a.useEffect)((function(){u&&o&&(w(!0),Ye(ae.getAssignedUsersByRoleId(u.id)).then((function(e){var t=[];e.forEach((function(e){return e.has&&t.push(e.id)})),g(e),O(t),w(!1)})))}),[o,u]),Object(a.useImperativeHandle)(t,(function(){return{setVisible:function(e,t,n){k.current=n,m(t),c(e)}}})),r.a.createElement(U.a,{title:"分配角色",className:"role-tab-assign-user",width:600,visible:o,maskClosable:!1,onClose:I,extra:r.a.createElement(G.b,null,r.a.createElement(V.a,{size:"small",onClick:I},"取消"),r.a.createElement(V.a,{type:"primary",size:"small",disabled:j,loading:N,onClick:function(){u&&(C(!0),Ye(ae.assignRoles,{method:"POST",data:{flag:!1,id:u.id,idList:E}}).then((function(e){X.success("成功为角色分配用户"),k.current(),I()}),(function(){return C(!1)})))}},"确定"),r.a.createElement(H.a,{type:"vertical"}))},r.a.createElement(Se.a,{gutter:[12,12],className:"desc-row"},r.a.createElement(Pe.a,{span:3,className:"label-col"},"角色名称:"),r.a.createElement(Pe.a,{span:21,className:"value-col"},u&&u.roleName),r.a.createElement(Pe.a,{span:3,className:"label-col"},"描述:"),r.a.createElement(Pe.a,{span:21,className:"value-col"},u&&u.description)),r.a.createElement(Ge.a,{spinning:j},r.a.createElement(Ve.a,{titles:["未分配用户","已分配用户"],dataSource:f,rowKey:function(e){return e.id},render:function(e){return e.name},showSearch:!0,filterOption:function(e,t){return t.name.includes(e)},targetKeys:E,onChange:function(e){O(e)},pagination:!0,suffix:r.a.createElement(He.a,{type:"icon-fangdajing"})})))})),Ze=function(e){var t=T.a.useGlobalValue(),n=F()(t,1)[0],i=e.curTabKey,o=Object(a.useState)([]),c=F()(o,2),l=c[0],s=c[1],u=Object(a.useState)(re),m=F()(u,2),d=m[0],p=m[1],f=Object(a.useState)(!0),g=F()(f,2),b=g[0],h=g[1],E=Object(a.useState)(-1),O=F()(E,2),v=O[0],y=O[1],j=Object(a.useState)(""),w=F()(j,2),S=w[0],P=w[1],N=Object(a.useState)(""),C=F()(N,2),k=C[0],I=C[1],x=Object(a.useRef)(null),D=Object(a.useRef)(null),L=[{title:"角色ID",dataIndex:"roleCode"},{title:"名称",dataIndex:"roleName"},{title:"描述",dataIndex:"description",lineClampOne:!0},{title:"分配用户数",dataIndex:"authedUserCnt",width:100,render:function(e,t){return e?r.a.createElement(ke.a,{placement:"right",overlayClassName:"tags-with-hide-popover",content:r.a.createElement("div",{className:"container-item-popover"},t.authedUsers.map((function(e){return r.a.createElement("div",{key:e,className:"container-item"},e)})))},r.a.createElement(V.a,{size:"small",type:"link"},e)):r.a.createElement(V.a,{size:"small",type:"link"},e)}},{title:"最后修改人",dataIndex:"lastReviser"},{title:"最后更新时间",dataIndex:"updateTime",width:180,render:function(e){return Q()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"操作",width:260,render:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{type:"link",size:"small",style:{paddingLeft:0},onClick:function(){return x.current.onOpen(!0,pe.View,z,e)}},"查看详情"),n.hasPermission&&n.hasPermission(ne.ROLE_ASSIGN)?r.a.createElement(V.a,{type:"link",size:"small",onClick:function(){return D.current.setVisible(!0,e,z)}},"分配用户"):r.a.createElement(r.a.Fragment,null),n.hasPermission&&n.hasPermission(ne.ROLE_EDIT)?r.a.createElement(V.a,{type:"link",size:"small",onClick:function(){return x.current.onOpen(!0,pe.Edit,z,e)}},"编辑"):r.a.createElement(r.a.Fragment,null),n.hasPermission&&n.hasPermission(ne.ROLE_DEL)?r.a.createElement(V.a,{type:"link",size:"small",onClick:function(){return R(e)}},e.id===v?r.a.createElement(Be.a,null):"删除"):r.a.createElement(r.a.Fragment,null))}}],z=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=qe({page:d.current,size:d.pageSize,roleName:S},t);h(!0),Ye(ae.roleList,{method:"POST",data:n}).then((function(t){var n=t.pagination,a=n.pageNo,r=n.pageSize,i=n.pages,o=n.total;if(a>i&&0!==i)return e({page:i}),!1;p(qe(qe({},d),{},{current:a,pageSize:r,total:o})),s(t.bizData),h(!1)}),(function(){return h(!1)}))},R=function(e){-1===v&&(y(e.id),Ye(ae.checkRole(e.id),{method:"DELETE"}).then((function(t){y(-1);var n=t&&t.userNameList,a=!(n&&n.length),i=!a&&n.length>2;Ke({title:a?"确定删除以下角色吗?":"请先解除角色引用关系",content:r.a.createElement("div",null,r.a.createElement("div",null,e.roleName),!a&&r.a.createElement("span",null,"已被用户 “",i?r.a.createElement(q.a,{title:n.join("，")},n.slice(0,2).join("，"),"...等 ",n.length," 人"):n.join("，"),"” 引用，请先解除引用关系")),okText:a?"删除":"确定",okType:"primary",centered:!0,okButtonProps:{size:"small",danger:a},cancelButtonProps:{size:"small"},maskClosable:!0,onOk:function(){return a&&Ye(ae.role(e.id),{method:"DELETE"}).then((function(e){X.success("删除成功"),z()}))},onCancel:function(){}})}),(function(){return y(-1)})))};return Object(a.useEffect)((function(){"role"===i&&z()}),[i]),Object(a.useEffect)((function(){(S||""===S)&&z({pageNo:1})}),[S]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"operate-bar"},r.a.createElement("div",{className:"left"},r.a.createElement("div",{className:"refresh-icon",onClick:function(){return z()}},r.a.createElement(He.a,{className:"icon",type:"icon-shuaxin1"}))),r.a.createElement("div",{className:"right"},r.a.createElement(_.a,{className:"search-input",suffix:r.a.createElement(He.a,{type:"icon-fangdajing",onClick:function(e){P(k)},style:{fontSize:"16px"}}),placeholder:"请输入角色名称",value:k,onPressEnter:function(e){P(k)},onChange:function(e){I(e.target.value)}}),n.hasPermission&&n.hasPermission(ne.ROLE_ADD)?r.a.createElement(V.a,{type:"primary",icon:r.a.createElement(Z.a,null),onClick:function(){return x.current.onOpen(!0,pe.Add,z,void 0)}},"新增角色"):r.a.createElement(r.a.Fragment,null))),r.a.createElement(Y.a,{tableProps:{showHeader:!1,loading:b,rowKey:"id",dataSource:l,paginationProps:d,columns:L,lineFillColor:!0,attrs:{onChange:function(e){z({page:e.current,size:e.pageSize})},scroll:{scrollToFirstRowOnChange:!0,x:!0,y:"calc(100vh - 326px)"}}}}),r.a.createElement(We,{ref:x}),r.a.createElement(Xe,{ref:D}))},$e=Oe.a.TabPane,Qe=function(){var e,t=Object(a.useState)((null===(e=window.history.state)||void 0===e?void 0:e.tab)||"user"),n=F()(t,2),i=n[0],o=n[1];return r.a.createElement(ie,{title:"用户管理"},r.a.createElement(Oe.a,{defaultActiveKey:i,onChange:function(e){o(e),window.history.replaceState({tab:e},"")}},r.a.createElement($e,{tab:"人员管理",key:"user"},r.a.createElement(Ue,{curTabKey:i})),r.a.createElement($e,{tab:"角色管理",key:"role"},r.a.createElement(Ze,{curTabKey:i}))))},et=n(182);function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){f()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var at=d.a.request,rt=et.a.RangePicker,it=[{path:"",exact:!1,component:function(){return r.a.createElement(s.Redirect,{to:"/setting"})},commonRoute:se,children:[{path:"setting",exact:!0,component:function(){var e=T.a.useGlobalValue(),t=F()(e,1)[0],n=Object(a.useState)(!0),i=F()(n,2),o=i[0],c=i[1],l=Object(a.useState)([]),s=F()(l,2),u=s[0],m=s[1],d=Object(a.useState)([]),p=F()(d,2),f=p[0],g=p[1],h=Object(a.useState)(re),E=F()(h,2),O=E[0],v=E[1],y=A.a.useForm(),j=F()(y,1)[0],w=Object(a.useRef)(null),S=Object(a.useRef)(null),P=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=j.getFieldsValue(),a=me(me({page:O.current,size:O.pageSize},n),t);c(!0),fe(ae.configList,{method:"POST",data:a}).then((function(t){var n=t.pagination,a=n.pageNo,r=n.pageSize,i=n.pages,o=n.total;if(a>i&&0!==i)return e({page:i}),!1;v(me(me({},O),{},{current:a,pageSize:r,total:o})),g(t.bizData),c(!1)}),(function(){return c(!1)}))},N=Object(a.useCallback)((function(){var e=[{title:"模块",dataIndex:"valueGroup",lineClampOne:!0},{title:"配置键",dataIndex:"valueName",width:150,lineClampOne:!0,render:function(e){return r.a.createElement(q.a,{title:e},r.a.createElement("div",{className:"text-overflow-two-row"},e))}},{title:"配置值",dataIndex:"value",width:180,lineClampOne:!0,render:function(e){return r.a.createElement("div",{className:"text-overflow-two-row hover-light",onClick:function(){return S.current.setVisible(!0,e)}},e)}},{title:"描述",dataIndex:"memo",width:180,lineClampOne:!0},{title:"启用状态",dataIndex:"status",render:function(e,t){return r.a.createElement("div",{style:{width:60}},r.a.createElement(M.a,{checked:1===e,size:"small",onChange:function(){fe(ae.configSwtichStatus,{method:"POST",data:{id:t.id,status:1===e?2:1}}).then((function(e){P()}))}}))}},{title:"最后更新时间",dataIndex:"updateTime",render:function(e){return Q()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"最后更新人",dataIndex:"operator",width:100,lineClampOne:!0}];return t.hasPermission&&(t.hasPermission(ne.CONFIG_EDIT)||t.hasPermission(ne.CONFIG_DEL))&&e.push({title:"操作",dataIndex:"",width:130,lineClampOne:!1,render:function(e){return r.a.createElement(r.a.Fragment,null,t.hasPermission&&t.hasPermission(ne.CONFIG_EDIT)?r.a.createElement(V.a,{type:"link",size:"small",onClick:function(){return w.current.onOpen(!0,le.Edit,P,u,e)},style:{paddingLeft:0}},"编辑"):r.a.createElement(r.a.Fragment,null),t.hasPermission&&t.hasPermission(ne.CONFIG_DEL)?r.a.createElement(V.a,{type:"link",size:"small",onClick:function(){return C(e)}},"删除"):r.a.createElement(r.a.Fragment,null))}}),e}),[t,P,u]),C=function(e){ge({title:"确定删除配置吗?",content:"配置 [".concat(e.valueName,"] ").concat(1===e.status?"为启用状态，无法删除":""),centered:!0,okText:"删除",okType:"primary",okButtonProps:{size:"small",disabled:1===e.status,danger:!0},cancelButtonProps:{size:"small"},maskClosable:!0,onOk:function(){return fe(ae.delConfig,{method:"DELETE",params:{id:e.id}}).then((function(e){X.success("删除成功"),P()}))}})};return Object(a.useEffect)((function(){fe(ae.configGroupList).then((function(e){var t=e.map((function(e){return{label:e,value:e}}));m(t)})),P()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{title:"配置管理"},r.a.createElement("div",{className:"config-manage-page"},r.a.createElement("div",{className:"operate-bar"},r.a.createElement("div",{className:"left"},r.a.createElement("div",{className:"refresh-icon",onClick:function(){return P()}},r.a.createElement(b.a,{className:"icon",type:"icon-shuaxin1"})),r.a.createElement(H.a,{type:"vertical",style:{height:20,top:0}}),r.a.createElement(A.a,{form:j,layout:"inline",onFinish:function(){return P({page:1})}},r.a.createElement(A.a.Item,{name:"valueGroup"},r.a.createElement(B.a,{style:{width:180},placeholder:"请选择模块",options:u})),r.a.createElement(A.a.Item,{name:"valueName"},r.a.createElement(_.a,{style:{width:180},placeholder:"请输入配置键"})),r.a.createElement(A.a.Item,{name:"memo"},r.a.createElement(_.a,{style:{width:180},placeholder:"请输入描述"})),r.a.createElement(A.a.Item,null,r.a.createElement(V.a,{type:"primary",ghost:!0,htmlType:"submit"},"查询")))),t.hasPermission&&t.hasPermission(ne.CONFIG_ADD)?r.a.createElement(V.a,{type:"primary",icon:r.a.createElement(Z.a,null),onClick:function(){return w.current.onOpen(!0,le.Add,P,u)}},"新增配置"):r.a.createElement(r.a.Fragment,null)),r.a.createElement(Y.a,{tableProps:{showHeader:!1,loading:o,rowKey:"id",dataSource:f,paginationProps:O,columns:N,lineFillColor:!0,attrs:{onChange:function(e){P({page:e.current,size:e.pageSize})},scroll:{scrollToFirstRowOnChange:!0,x:!0,y:"calc(100vh - 270px)"}}}}))),r.a.createElement(he,{ref:w}),r.a.createElement(Ee,{ref:S}))}},{path:"user",exact:!0,component:Qe},{path:"operation-log",exact:!0,component:function(){var e=Object(a.useState)(!0),t=F()(e,2),n=t[0],i=t[1],o=Object(a.useState)([]),c=F()(o,2),l=c[0],s=c[1],u=Object(a.useState)([]),m=F()(u,2),d=m[0],p=m[1],f=Object(a.useState)(re),g=F()(f,2),h=g[0],E=g[1],O=A.a.useForm(),v=F()(O,1)[0],y=[{title:"模块",dataIndex:"targetType",lineClampOne:!0},{title:"操作对象",dataIndex:"target",width:350,lineClampOne:!0},{title:"行为",dataIndex:"operateType",width:80,lineClampOne:!0},{title:"操作内容",dataIndex:"detail",width:350,lineClampOne:!0,render:function(e){return r.a.createElement(q.a,{placement:"bottomLeft",title:e},e)}},{title:"操作时间",dataIndex:"updateTime",width:200,render:function(e){return Q()(e).format("YYYY-MM-DD HH:mm:ss")}},{title:"操作人",dataIndex:"operator"}],j=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=v.getFieldsValue();n.time&&(n.startTime=Q()(n.time[0]).valueOf(),n.endTime=Q()(n.time[1]).valueOf()),delete n.time;var a=nt(nt({page:h.current,size:h.pageSize},n),t);i(!0),at(ae.oplogList,{method:"POST",data:a}).then((function(t){var n=t.pagination,a=n.pageNo,r=n.pageSize,o=n.pages,c=n.total;if(a>o&&0!==o)return e({page:o}),!1;E(nt(nt({},h),{},{current:a,pageSize:r,total:c})),p(t.bizData),i(!1)}),(function(){return i(!1)}))};return Object(a.useEffect)((function(){at(ae.oplogTypeList).then((function(e){var t=e.map((function(e){return{label:e,value:e}}));s(t)})),j()}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{title:"操作记录"},r.a.createElement("div",{className:"operate-bar"},r.a.createElement("div",{className:"left"},r.a.createElement("div",{className:"refresh-icon",onClick:function(){return j()}},r.a.createElement(b.a,{className:"icon",type:"icon-shuaxin1"})),r.a.createElement(H.a,{type:"vertical",style:{height:20,top:0}}),r.a.createElement(A.a,{form:v,layout:"inline",onFinish:function(){return j({page:1})}},r.a.createElement(A.a.Item,{name:"targetType"},r.a.createElement(B.a,{placeholder:"请选择模块",options:l,style:{width:160}})),r.a.createElement(A.a.Item,{name:"target"},r.a.createElement(_.a,{placeholder:"请输入操作对象"})),r.a.createElement(A.a.Item,{name:"detail"},r.a.createElement(_.a,{placeholder:"请输入操作内容"})),r.a.createElement(A.a.Item,{name:"time"},r.a.createElement(rt,{showTime:!0})),r.a.createElement(A.a.Item,null,r.a.createElement(V.a,{type:"primary",ghost:!0,htmlType:"submit"},"查询"))))),r.a.createElement(Y.a,{tableProps:{showHeader:!1,loading:n,rowKey:"id",dataSource:d,paginationProps:h,columns:y,lineFillColor:!0,attrs:{onChange:function(e){j({page:e.current,size:e.pageSize})},scroll:{scrollToFirstRowOnChange:!0,x:!0,y:"calc(100vh - 270px)"}}}})))}}]}],ot={"zh-CN":{dantd:P.a,intl:"zh-CN",intlMessages:I},en:{dantd:N.a,intl:"en",intlMessages:x}},ct=r.a.createContext("zh"),lt=(ct.Provider,ct.Consumer,function(e){var t=e.getLicenseInfo,n=e.licenseEventBus;return r.a.createElement("div",{className:"config-system"},r.a.createElement(D.a.Sider,{prefixCls:"dcd-two-columns",width:200,theme:"light",systemKey:C,menuConf:k}),r.a.createElement(D.a.Content,null,r.a.createElement(L.a,{routeList:it,beforeEach:function(){return null==t||t((function(e){return null==n?void 0:n.emit("licenseError",e)})),Promise.resolve(!0)},noMatch:function(){return r.a.createElement(s.Redirect,{to:"/404"})}})))}),st=function(e){var t=e.getLicenseInfo,n=e.licenseEventBus,a=m.a.get(ot.zh,"intlMessages",I),i=m.a.get(ot.zh,"intl","zh-CN"),o=m.a.get(ot.zh,"dantd",P.a);return r.a.createElement("div",{id:"sub-system"},r.a.createElement(T.a,{intlProvider:{locale:i,messages:a},antdProvider:{locale:o}},r.a.createElement(s.BrowserRouter,{basename:C},r.a.createElement(s.Switch,null,r.a.createElement(lt,{getLicenseInfo:t,licenseEventBus:n})))))};var ut=l()({React:r.a,ReactDOM:o.a,rootComponent:st,domElementGetter:function(){var e=document.getElementById("ks-layout-container");return e||((e=document.createElement("div")).id="ks-layout-container",document.body.appendChild(e)),e}}),mt=[ut.bootstrap],dt=[ut.mount],pt=[ut.unmount]},41:function(e,n){e.exports=t},43:function(e,t){e.exports=n},46:function(e,t){e.exports=a},48:function(e,t){e.exports=r}})}));